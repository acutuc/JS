<!DOCTYPE html>
<html>

<head>
    <title>UNION LIST</title>
</head>

<body>
    PRIMERA LISTA:
    <ul id="lista1">
        <li>manzana</li>
        <li>pera</li>
        <ul>
            <li>conferencia</li>
            <ul>
                <li>conferenciaverde</li>
                <li>conferenciaamarilla</li>
                <li>conferenciaroja</li>
            </ul>
            <li>peradeagua</li>
            <li>peritadulce</li>
            <ul>
                <li>Dimas</li>
                <li>Gestas</li>
                <li>Malakatos</li>
                <li>Jose</li>
            </ul>
        </ul>
        <li>limon</li>
        <li>limon</li>
        <li>LIMON</li>
    </ul>
    Segunda lista:
    <ul id="lista2">
        <li>manzana</li>
        <li>manzana</li>
        <ul>
            <li>manzana</li>
            <li>manzana</li>
            <li>manzana</li>
        </ul>
        <li>pera</li>
        <li>limon</li>
    </ul>
    <ol id="lista3">
    </ol>
    <script>
        //Almacenamos en un array las listas.
        let listas = (lista) => {
            let aux = [];
            if (lista.tagName == "LI") {
                aux.push(lista.innerHTML.toUpperCase())
            } else {
                Array.from(lista.children).map(element => aux.push(listas(element)));
            }
            return aux.flat(Infinity).sort()
        }
        
        //Lista1:
        let lista1 = listas(document.getElementById("lista1"));

        //Lista2:
        let lista2 = listas(document.getElementById("lista2"));

        //Lista3:
        let lista3 = []

        //Mostramos las listas:
        console.log("LISTAS CON ELEMENTOS REPETIDOS:")
        console.log(lista1);
        console.log(lista2);
        console.log("---------------------------------")

        //Quitamos los elementos repetidos de las listas:
        let listaUnica1 = lista1.filter((valor, indice) => {
            return lista1.indexOf(valor) == indice;
        })

        let listaUnica2 = lista2.filter((valor, indice) => {
            return lista2.indexOf(valor) == indice;
        })

        console.log("LISTAS CON ELEMENTOS SIN REPETIR:")
        console.log(listaUnica1);
        console.log(listaUnica2);
        console.log("--------------------------------")

        //FunciÃ³n que itera sobre las dos listas e inserta en la tercera.:
        const resuelveEj = (lis1, lis2, lis3) => {
            lis1.map(e => lis3.push(e));
            lis2.map(e => lis3.push(e));
            lis3.sort().map((valor, indice, arr) => {
                if(arr[indice] != arr[indice-1]){
                    document.getElementById("lista3").innerHTML += "<li>"+valor+"</li>";
                }
            })
        }

        resuelveEj(listaUnica1, listaUnica2, lista3);

    </script>
</body>

</html>